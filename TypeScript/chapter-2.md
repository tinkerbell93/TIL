# 2. 타입스크립트: 3,000미터 상공에서 내려다보기

## 2.1 컴파일러

**[타입스크립트 컴파일 및 진행]**

- 타입스크립트
  1. 타입스크립트 소스 => 타입스크립트 AST(추상적 구문 트리)파싱
  2. **타입 검사기**가 AST를 확인
  3. 타입스크립트 AST => 자바스크립트 소스
- 자바스트립트
  4. 자바스크립트 소스 => 자바스크립트 AST파싱
  5. AST => 바이트코드
  6. 런타임에 바이트코드를 평가

타입스크립트는 타입 검사기가 컴파일 되는 시점에 타입을 검사하고 자바스크립트는 개발자가 사용한 타입을 확인만 할 뿐 타입 정보는 최종적으로 만들어지는 프로그램에 영향을 주지 않는다. 



## 2.2 타입시스템

> **타입시스템이란?**
>
> 타입 검사기가 프로그램에 타입을 할당하는 데 사용하는 규칙 집합



**[타입시스템의 종류]**

- 타입을 명시적으로 알려주는 타입시스템

  어노테이션을 이용

  ```js
  let a: number = 1;
  let b: string = "hello";
  let c: boolean[] = [true, false];	// c는 boolean 배열
  ```

- 타입을 자동으로 추론하는 타입시스템

  어노테이션을 이용하지 않으면 타입스크립트가 알아서 타입을 추론함

  ```js
  let a = 1;
  let b = "hello";
  let c = [true, false];	
  ```

> :tipping_hand_woman:
>
> 타입스크립트가 타입을 추론하도록 두는 것이 코드를 줄일 수 있는 방법이므로 보통 어노테이션은 생략한다.



### 2.2.1 타입스크립트 vs 자바스크립트

| 타입 시스템 기능            | 자바스크립트   | 타입스크립트        |
| --------------------------- | -------------- | ------------------- |
| 타입 결정 방식              | 동적           | 정적                |
| 타입이 자동으로 변환되는가? | O              | X(대부분)           |
| 언제 타입을 확인하는가?     | 런타임         | 컴파일 타임         |
| 언제 에러를 검출하는가?     | 런타임(대부분) | 컴파일 타임(대부분) |



**타입은 어떻게 결정되는가?**

- 자바스크립트

  동적 타입 바인딩으로 프로그램을 실행하기 전에는 타입을 알 수 없다.

- 타입스크립트

  개발자가 명시적으로 타입을 지정할 수도 있지만 모든 타입을 지정하지 않아도 되며, 그 중 일부 타입을 추론해서 오류를 검출할 수 있다. 다만 모든 타입을 알지 못하는 상황에서는 많은 오류가 사용자에게 그대로 노출될 수 있다.



**자동으로 타입이 변환되는가?**

- 자바스크립트

  암묵적으로 타입 변환을 하여 결과를 도출한다.

- 타입스크립트

  유효하지 않은 작업을 발견하는 즉시 에러를 발생 시킨다.



**언제 타입을 검사하는지?**

- 자바스크립트

  주어진 상황에서 개발자가 무엇을 의도하는지에 맞춰 변환하려 최대한 노력할 뿐 거의 대부분의 상황에서 타입이 무엇인지 따지지 않는다.

- 타입스크립트

  정적으로 코드를 분석해 에러를 검출하여 코드를 실행하기도 전에 알려준다.



**에러는 언제 검출되는가?**

- 자바스크립트

  런타임에 예외를 던지거나 암묵적으로 형변환을 수행한다. 즉, 프로그램이 시작할때만 알 수 있다.

- 타입스크립트

  컴파일 타입에 문법 에러와 타입 관련 에러를 모두 검출한다.



## 2.3 코드 편집기 설정

#### 2.3.1 tsconfig.json

타입스크립트의 프로젝트에서 어떤 파일을 컴파일하고, 어떤 자바스킙트 버전으로 방출하는지 등을 정의한다.

`./node_modules/.bin/tsc --init`

```json
{
  "compilerOptions": {
    "lib": ["ES2015"],	
    "module": "commonjs",
    "outDir": "dist",
    "sourceMap": true,
    "target": "ES2015"
  },
  "include": [
    "src"
  ]
}
```

| 옵션   | 설명                                                   |
| ------ | ------------------------------------------------------ |
| lib    | TSC가 코드 실행 환경에서 이용할 수 있다고 가정하는 API |
| module | TSC가 코드를 컴파일할 대상 모듈 시스템                 |
| outDir | 생성된 자바스크립트 코드를 출력할 디렉터리             |
| target | TSC가 코드를 컴파일할 자바스크립트 버전                |
| strict | 유효하지 않은 코드를 확인할 때 가능한 한 엄격하게 검사 |

#### 2.3.2 tslint.json

타입스크립트의 코딩 스타일 규약을 정의

`./node_modules/.bin/tslint --init`





---

컴파일러 어노테이션 번들러



